# os homework6
于新雨 计25 2022010841

## 题目1
Buddy System:    
数据结构：空闲块按⼤⼩和起始地址组织成⼆维数组   
初始状态：只有一个大小为 2^U 的空闲块   

分配过程：
由⼩到⼤在空闲块中找最⼩可⽤块，如空闲块过⼤，对可⽤空闲块进⾏⼆等分，直到得到合适可⽤空闲块    

释放过程：    
把块放到空闲块数组，并且合并满足条件的空闲块   

2. 
![alt text](b82708c0738c0b0281acbbca561e9af.jpg)    

## 题目2
先访问第二个页面，页表命中，进程的驻留集是指当前实际驻留在物理内存中的进程页面集合    
所以时间是两次内存访问的时间和两次 tlb 访问的时间（一次发现不命中，一次是更新 tlb 的时间）    
是 220 ns    

然后访问第一个页面，未命中，需要 10^7 ns 然后更新驻留集需要 100 ns，共需要 10^7 + 100 ns    
访问第二个页面，命中 tlb 命中驻留集，共需要 110 ns    

## 题目3

2. rcore 目前的分配器是 StackFrameAllocator, 此外还有一个 HeapAllocator,基本照搬了 Buddy System 的做法，实现较为简单，而与之对照，slab allocator 实现过于复杂，若迁移，则实现成本会较大    

所以可能进行的改进主要是加那个 slab allocator 的 cache 实现，在新建对象时，如果在 cache 可以找到现有的，就直接拿来用，否则分配内存并新建对象，释放对象时，直接放到 cache 里面并且不调用 destructor     
并且实现 slab 和 slab coloring 算法，但是双层的 free_list 可能就不会实现了     

![alt text](./image-2.png)